# read multiple impurity data files:
nzdf=3
mcfilename(1:nzdf)=["He_rates.strahl","C_rates.strahl","Ne_rates.strahl"]
call readmc

# setup to test mcrates :
integer ntt=600		# number of temperature test values
double ttmax=100.	# maximum temperature (eV)
double ttmin=1.		# minimum temperature (eV)
double tt(0:ntt)=ev*\
                 exp(log(ttmin)+(log(ttmax)-log(ttmin))*iota(0:ntt)/float(ntt))
double rion(0:ntt),rrec(0:ntt),rcxr(0:ntt)

# test the data for each impurity:
integer i,za,zamax,zn

timer on
zamax=2; zn=2
do i=0,ntt
  do za=0,zamax
    call mcrates(tt(i),tt(i),za,zamax,zn,&rion(i),&rrec(i),&rcxr(i))
  enddo
enddo
#double rion_He=rion,rrec_He=rrec,rcxr_He=rcxr
timer off

timer on
zamax=6; zn=6
do i=0,ntt
  do za=0,zamax
    call mcrates(tt(i),tt(i),za,zamax,zn,&rion(i),&rrec(i),&rcxr(i))
  enddo
enddo
#double rion_C=rion,rrec_C=rrec,rcxr_C=rcxr
timer off

timer on
zamax=10; zn=10
do i=0,ntt
  do za=0,zamax
    call mcrates(tt(i),tt(i),za,zamax,zn,&rion(i),&rrec(i),&rcxr(i))
  enddo
enddo
#double rion_Ne=rion,rrec_Ne=rrec,rcxr_Ne=rcxr
timer off





