PPPL Rate Tables for Hydrogen (M. E. Rensink, 11 Jan 2002):

The hydrogenic rates contained in the ehr2.dat file were converted to
a table that uses the impurity rate table format (b2frates) by reading
the script convert_ehr1.txt within UEDGE. (see the directory
~rensink/home/uedge/in/aph/ for these files).  A copy has also been
placed in the directory ~rensink/home/uedge/in/api/.
 
ADPAK, STRAHL and ADAS Rate Tables (M. E. Rensink, 04 Aug 2000):


The impurity rate tables that are used with the ismctab=2 option in
UEDGE are generated by running the pre-processor package in Braams'
B2.5 code.  Executables for most platforms have been created by Dave
Coster and are stored in AFS.  Following are his instructions on how
to generate the tables (default file name is "b2frates").  I have used
my account on the PPPL unix cluster for this purpose because it has
AFS available; our LLNL cluster does not.  Also, for ADAS-based
tables, it is necessary to copy the required ADAS adf11-format files
from the GA computer system to the PPPL directories designated in the
file "ratadas.filelist".

NOTE: These tables could also be generated on the NERSC computers,
e.g., k.nersc.gov, but the unicos version of the executable in AFS has
not been updated recently and does not seem to work under the current
operating system - the error message is "Stale NFS handle".

########### E-mail message from Dave Coster 21 Jun 2000 ###############

Another possibility is just to use the IPP-Garching version of the
code.

I have set up 3 globally writable directories in my AFS area.  You
should be able to execute the code by doing something along the lines
of:

cd /afs/ipp-garching.mpg.de/u/dpc/solps-test/solps5.0_test
source setup.csh
sbb
cd ../runs/RATES/ADPAK
### rm b2ar.prt b2frates				### MER comment
### edit b2ar.dat for desired atomic elements		### MER comment
gmake -f ../../Makefile b2ar.prt
cd ../STRAHL/
### rm b2ar.prt b2frates				### MER comment
### edit b2ar.dat for desired atomic elements		### MER comment
gmake -f ../../Makefile b2ar.prt
cd ../ADAS
### rm b2ar.prt b2frates;				### MER comment
### edit b2ar.dat for desired atomic elements		### MER comment
### edit ratadas.filelist for desired dataset(s)	### MER comment
gmake -f ../../Makefile b2ar.prt

the "source setup.csh" should automatically detect your machine type
and then set the environment variable OBJECTCODE appropriately.
Currently we have versions compiled for

1675 -rwxr-xr-x   1    2400      1715136 Apr 18  1997 unicos/b2ar.exe*
 552 -rwxr-xr-x   1    users      565248 Oct 20  1998 DECalpha/b2ar.exe*
 270 -rwxr-xr-x   1    2400       275779 Mar 10  1999 g77/b2ar.exe*
1186 -rwxr-xr-x   1    2400      1213472 Mar 16  1999 sun5.Fujitsu/b2ar.exe*
 796 -rwxr-xr-x   1    2400       814452 Mar 26  1999 SGIirix/b2ar.exe*
 361 -rwxr-xr-x   1    2400       369349 May 29  1999 linux_nag_f95/b2ar.exe*
 551 -rwxr-xr-x   1    2400       564064 Jun 24  1999 sun5/b2ar.exe*
 371 -rwxr-xr-x   1    2400       378994 Sep 23  1999 linux_pgf90.-O2/b2ar.exe*
 404 -rwxr-xr-x   1    2400       413491 Sep 24  1999 linux_pgf90/b2ar.exe*
 292 -rwxr-xr-x   1    2400       298528 Nov 17  1999 IBMaix.debug/b2ar.exe*
 232 -rwxr-xr-x   1    2400       236807 Nov 17  1999 IBMaix/b2ar.exe*
 474 -rwxr-xr-x   1    2400       484835 May  2 06:36 linux.Fujitsu/b2ar.exe*

unicos, sun, DECalpha, SGI, linux and IBMaix.  sbb takes you the the
"base" directory, and the runs are done in subdirectories of the "runs"
directory, one level up from the "base" directory.  There are three
cases in "RATES": ADPAK, STRAHL and ADAS versions of the tables for
H+C.  For the ADAS version, you will need to change the
"ratadas.filelist" file so that the 1st line points to your ADAS
directory.

#######################################################################


# To get the adf11-format files from GA:

# log onto one of the LSF cluster machines (hera, irenic, nemsis,
# badger, ulam, ...)

ssh hera.gat.com

hera.gat.com:rensink(adf11)> cd /c/ADAS/adas/adf11
hera.gat.com:rensink(adf11)> ls
acd74/   acd85/   acd89/   acd93/   acd93r/  acd96/   acd96r/  ccd89/
ccd96/   ccd96r/  pls89/   pls96/   plt89/   plt93/   plt93r/  plt96/
plt96r/  prb89/   prb93/   prb93r/  prb96/   prb96r/  prc89/   prc96/
prc96r/  qcd93r/  qcd96r/  scd74/   scd85/   scd89/   scd93/   scd93r/
scd96/   scd96r/  xcd93r/  xcd96r/

# NOTE on directory names:
acd=recombination
ccd=charge exchange
pls=
plt=line radiation
prb=bremsstrahlung
prc=
qcd=
scd=ionization
xcd=

# We need only the acd, ccd, plt, prb and scd files.

# In each directory are the files for the available elements, e.g.,

hera.gat.com:rensink(adf11)> ls acd89
acd89_ar.dat   acd89_b.dat*   acd89_be.dat*  acd89_c.dat*   acd89_cl.dat*
acd89_f.dat*   acd89_h.dat*   acd89_he.dat*  acd89_kr.dat*  acd89_n.dat*
acd89_ne.dat*  acd89_ni.dat*  acd89_o.dat*   acd89_s.dat*   acd89_si.dat*
acd89_xe.dat*

# Create a tar-file that contains all the data for a given year, e.g., 93:

# Start from the ADAS HOME directory so as to produce the correct path
# when we un-tar the files at PPPL.
hera.gat.com:rensink(rensink)> cd /c/ADAS

hera.gat.com:rensink(ADAS)> tar cvf ~/adas93.tar adas/adf11/acd93/* adas/adf11/ccd93/* adas/adf11/plt93/* adas/adf11/prb93/* adas/adf11/scd93/*

hera.gat.com:rensink(ADAS)> cd ~/

hera.gat.com:rensink(rensink)> tar tvf adas93.tar
blocksize = 256
-rwxr-xr-x  2225/520   38404 Mar 21 05:11:48 1995 adas/adf11/acd93/acd93_be.dat
-rwxr-xr-x  2225/520   57042 Mar 21 05:11:48 1995 adas/adf11/acd93/acd93_c.dat
-rwxr-xr-x  2225/520  141568 Jul 14 03:30:32 1995 adas/adf11/acd93/acd93_fe.dat
-rwxr-xr-x  2225/520   11096 Mar 21 05:11:48 1995 adas/adf11/acd93/acd93_h.dat
-rwxr-xr-x  2225/520   22596 Mar 21 05:11:48 1995 adas/adf11/acd93/acd93_o.dat
-rwxr-xr-x  2225/520   38396 Mar 21 05:18:51 1995 adas/adf11/plt93/plt93_be.dat
-rwxr-xr-x  2225/520   57034 Mar 21 05:18:51 1995 adas/adf11/plt93/plt93_c.dat
-rwxr-xr-x  2225/520   11068 Mar 21 05:18:51 1995 adas/adf11/plt93/plt93_h.dat
-rwxr-xr-x  2225/520   22588 Mar 21 05:18:51 1995 adas/adf11/plt93/plt93_o.dat
-rwxr-xr-x  2225/520   38396 Mar 21 05:19:26 1995 adas/adf11/prb93/prb93_be.dat
-rwxr-xr-x  2225/520   57034 Mar 21 05:19:26 1995 adas/adf11/prb93/prb93_c.dat
-rwxr-xr-x  2225/520   10583 Mar 21 05:19:26 1995 adas/adf11/prb93/prb93_h.dat
-rwxr-xr-x  2225/520   22588 Mar 21 05:19:26 1995 adas/adf11/prb93/prb93_o.dat
-rwxr-xr-x  2225/520   38404 Mar  7 02:23:53 1995 adas/adf11/scd93/scd93_be.dat
-rwxr-xr-x  2225/520   57042 Mar  7 02:23:54 1995 adas/adf11/scd93/scd93_c.dat
-rwxr-xr-x  2225/520  141156 Jul 14 03:30:53 1995 adas/adf11/scd93/scd93_fe.dat
-rwxr-xr-x  2225/520   11090 Mar  7 02:23:55 1995 adas/adf11/scd93/scd93_h.dat
-rwxr-xr-x  2225/520   22596 Mar  7 02:23:56 1995 adas/adf11/scd93/scd93_o.dat

hera.gat.com:rensink(rensink)> gzip adas93.tar

NOTE: The ccd files for adas93 are missing, so we will have to use
adas89 for the charge exchange tables.  The straightforward way to do
this is to modify the c-x entry in file ratadas.filelist, but there is
a bug that prevents this from working properly.  An alternative is to
manually create directory ccd93 in adf11 and copy the ccd89_*.dat
files to the ccd93 directory.

# Now we are ready to copy this file from GA to PPPL.

#######################################################################

# NOTE: First, establish a hole in the PPPL firewall via netscape; then

ssh orion.pppl.gov

orion.pppl.gov:rensink(rensink)> scp hera.gat.com:~/adas93.tar.gz .
orion.pppl.gov:rensink(rensink)> gunzip adas93.tar.gz
orion.pppl.gov:rensink(rensink)> tar xvf adas93.tar

# Now create the missing ccd (charge exchange) files:

orion.pppl.gov:rensink(rensink)> cd adas/adf11
orion.pppl.gov:rensink(adf11)> mkdir ccd93
orion.pppl.gov:rensink(adf11)> cd ccd93
orion.pppl.gov:rensink(ccd93)> cp ../ccd89/ccd89_be.dat ccd93_be.dat
orion.pppl.gov:rensink(ccd93)> cp ../ccd89/ccd89_c.dat ccd93_c.dat
orion.pppl.gov:rensink(ccd93)> cp ../ccd89/ccd89_fe.dat ccd93_fe.dat
orion.pppl.gov:rensink(ccd93)> cp ../ccd89/ccd89_h.dat ccd93_h.dat
orion.pppl.gov:rensink(ccd93)> cp ../ccd89/ccd89_o.dat ccd93_o.dat


# Finally, set permissions so as to protect ADAS data from public usage:
orion.pppl.gov:rensink(ccd93)> cd ..
orion.pppl.gov:rensink(adf11)> chmod 600 *93/*

# Now follow the procedure outlined by Coster.



